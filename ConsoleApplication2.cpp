//projet calculatrice qui prend toute la RAM
//modèle de calculatrice (avant qu'il y ait trop de chiffres) : on lit les deux nombres en binaire, on calcule leur nombre de 1 (et leur nombre de chiffre)
//si le nombre de 1 est + de 80% des chiffres : on fait un nombre 2^chiffres et on fait - la multiplication avec le nombre retourn� (1->0 ; 0-> 1) (nombre ^1)
//sinon on prend le nombre avec le moins de 1 et on fait la multiplication (une addition r�p�titive des nombres auxquels on a ajouter des 0 � la fin)
//la méthode serait (peut-�tre, mais j'en doute) un peut moins que O(n�)

#include <iostream>
#include <stdio.h>
#include <stdarg.h>
#include <Windows.h>
#include <string.h>
#include <wingdi.h>
#include <time.h>
#pragma comment(lib, "WinMM.lib")

void CreateConsoleWindow() {
    AllocConsole();  // Create a console window
    FILE* fileStream;
    freopen_s(&fileStream, "CONOUT$", "w", stdout);  // Redirect stdout to the console
    freopen_s(&fileStream, "CONOUT$", "w", stderr);  // Redirect stderr to the console
}

uint64_t uclen(unsigned char* input_) {
    uint64_t returned = 0;
    while (true) {
        if (input_[returned] == '\0') {
            return returned;
        }
        returned += 1;
    }
}

//Partie 1 : faire la multiplication simple
//Il faudra lire les bits directement (sinon la v�rification du nombre de 1 sera compliqu�e car elle devra se faire � la m�thode "classique")
uint8_t* conv(char* _Input, int* result_lenght) {
    unsigned char* final_variable = (unsigned char*)_Input; //convertion de _Input (variable d'entrée) en un truc plus utilisable
    int number_of_zeros = 0; //ça ça va compter le nombres de 0 depuis la gauche de _Input (ex : "001234", là ça sera 2)
    
    // verification de final_variable (si il y a autre chose que des chiffres)

    int a = uclen(final_variable); //évite de devoir faire des appels succesifs de uclen

    bool count_z = true;
    for (int i = 0; i < a; i++) { 
        if ((48 > final_variable[i] || final_variable[i] > 57)) {
            return (uint8_t*)calloc(1,1); //ce n'est pas un chiffre on retourne un uint8_t* vide
        }
        if (count_z && final_variable[i] == 48) {
            number_of_zeros += 1; // ici on va pré-compter le nombre de 0 depuis la gauche (car si quelqu'un mets "001234", ça va pas marcher)
            //on ajoute donc à number_of_zeros tant qu'il n'y a pas eu autre chose que des 0 (tracké par count_z)
        }
        if (count_z && final_variable[i] != 48) count_z = false;
    }
    
    uint64_t length = strlen(_Input)-number_of_zeros; //longeur de returned_int (calculée en avance) (on fait attention au number_of_zero) pour ne pas utiliser trop d'espace
    uint8_t rest = length % 3; //Ici, j'ai utilisé le fait que 1000 prenne 10 bits et donc je fait un calloc plus grand pour ne pas avoir à faire de realloc après (le calcul pourrait être optimiser je sais)
    if (rest != 0) {
        length = 1 + length / 3;
    }
    else {
        length = length / 3;
    }
    length = length * 10;
    rest = length % 8;
    if (rest != 0) {
        length = length / 8 + 1;
    }
    else length = length / 8;

    
    uint8_t* returned_int = (uint8_t*)calloc(length, sizeof(uint8_t)); //on fera une liste chaînée d'octets (0-255) (LITTLE ENDIAN)
    if (returned_int == NULL) {
        exit(45); //code d'éxit différends (pour savoir quelle alloc a foiré)
    }
    uint8_t current_number = 0; //stocke la prochaine valeur à ajouter à returned_int

    uint64_t pointer = 1; //compte la place que current_number devra modifier

    int nombre_operation = 0; //tracke la position du bit qu'on va ajouter à current_number 

    while (final_variable[0] != 10) { //la boucle finis tout le temps (on set final_variable[0] à 10 si nombre_de_zeros = a et il ne peut pas avoir deux zeros qui spawn en même temps de toute façon)
        if (final_variable[a - 1] % 2 == 1) {
            final_variable[a - 1] -= 1; //si le premier chiffre est impaire, on le soustrait (pour en avoir un pair) et il nous servira a faire current_number
            current_number += (1 << nombre_operation); //on utilise << pour bien décaler le bit
        }
        nombre_operation += 1;
        if (nombre_operation == 8) { //si c'est 8, on a fini l'octet, on passe donc au suivant
            returned_int[length-pointer] = current_number;
            current_number = 0;
            nombre_operation = 0;
            pointer++;
        }
        for (int i = a-1; i >= number_of_zeros; i--) { //on peut du coup aller jusqu'a number_of_zero exclus qui donc enlève des opérations
            if (final_variable[i] % 2 == 1) { //si chiffre impaire
                final_variable[i] -= 1; //on enlève 1
                final_variable[i + 1] += 5; //et on rajoute 5 au chiffre après (ex : 52/2 -> (i = 1) 2 est pair, donc on divise par 2 (-> 51) ; (i = 0) 5 est impaire (et 50/2 = 25) on enlève donc 1 (ça fait 4) puis on divise par 2 (ça fait 2) puis on ajoute 5 au chiffre d'avant (-> 26)
            }
            final_variable[i] = final_variable[i] / 2 + 24; // on divise après par 2 en sachant que le chiffre visé est pair et on ajoute 24 (puisque le code du chiffre est 48+chiffre il faut donc corriger le 48 qui a été divisé aussi)
            if (i == number_of_zeros && final_variable[i] == 48) { //si le chiffre le plus à gauche qui n'était pas un zero devient un zero, on ajoute 1 à number_of_zeros
                number_of_zeros += 1;
                if (number_of_zeros == a) { //si il n'y a plus que des 0, on change final_variable[0] à 10 qui arrêteras donc final_variable (il faut juste pas mettre des nombres entre 48 et 57 car ce sont des codes de chiffres)
                    final_variable[0] = 10;
                }
            } 
        }
    }
    returned_int[length-pointer] = current_number; //quand on sort de la boucle, il faut quand même changer le dernier returned_int
    

    //TEST : Faire un realloc depuis un pointer modifié pour enlever les 0 inutiles
    int64_t test = 0;
    for (int i = 0; returned_int[i] == 0; i++) {
        test++;
    }
    if (test != 0) {
        length = length - test;
        for (int i = 0; i < length; i++) {
            returned_int[i] = returned_int[i + test];
        }
        returned_int = (uint8_t*)realloc(returned_int, length); //il y aura assez de place, puisque la taille qu'il prend est plus petite
    }

    (*result_lenght) = length; //on change la longeur (donnée en entrée) car il faut la tracker (sizeof marche pas et si on cherche un 0 il peut y en a plein)
    return returned_int;
}

/* ----------------------------------------------- */

//fonction addition : c'est simple, il faut juste ajouter chaque uint8 dans un uint16 , prendre les 8 premiers bits et les mettres dans le uint8 du résultat puis mettre la retenue dans le premier bit (pour le prochain calcul) ; règle première : ne pas changer les variables d'entrée
uint8_t* addition_uint(uint8_t* _Arg1, int _Size1, uint8_t* _Arg2, int _Size2, int* _RSize) {
    //_Size1 -> len(_Arg1) ; _Size2 -> len(_Arg2) des _Size inexactes peuvent créer des erreurs
    //_RSize aura pour valeur à la fin la taille de resultat
    bool arg1_bigger = (_Size1 >= _Size2);
    int _min_ = min(_Size1, _Size2);
    int _max_ = max(_Size1, _Size2);
    int length = _max_ + 1;
    uint8_t* resultat = (uint8_t*)calloc(length, sizeof(uint8_t)); //on prend pour taille ça car c'est comme ça
    uint16_t nombre_pour_calcul = 0;
    for (int i = 1; i <= _min_ ; i++) { //on va jusqu'a min car sinon un uint8* sera vide
        nombre_pour_calcul += _Arg1[_Size1-i] + _Arg2[_Size2-i];
        resultat[length-i] = nombre_pour_calcul & 255; //prends les 8 premiers bits
        nombre_pour_calcul = nombre_pour_calcul >> 8; //on conserve la retenue
    }
    if (arg1_bigger) {
        for (int i = _min_+1; i <= _max_; i++) {
            nombre_pour_calcul += _Arg1[_Size1-i];
            resultat[length-i] = nombre_pour_calcul & 255;
            nombre_pour_calcul = nombre_pour_calcul >> 8;
        }
        resultat[0] = nombre_pour_calcul;
    }
    else {
        for (int i = _min_+1; i <= _max_; i++) {
            nombre_pour_calcul += _Arg2[_Size2-i];
            resultat[length-i] = nombre_pour_calcul & 255;
            nombre_pour_calcul = nombre_pour_calcul >> 8; 
        }
        resultat[0] = nombre_pour_calcul;
    }
    
    //recheck length (pour éviter d'utiliser de la mémoire pour rien)
    uint64_t retest = 0;
    for (int i = 0; resultat[i] == 0; i++) {
        retest++;
    }
    if (retest != 0) {
        length -= retest;
        for (int i = 0; i < length ; i++) {
            resultat[i] = resultat[i+retest];
        }
    }
    //(oui évidemment ça sert à rien sans realloc)
    resultat = (uint8_t*) realloc(resultat, length);
    if (_RSize != NULL) {
        (*_RSize) = length;
    }

    return resultat;
}

/* ----------------------------------------------- */

char* convert_to_str(uint8_t* from_, int size) {
    char* returned = (char*)(calloc(size*2+2,sizeof(char)));
    if (returned == NULL) {
        exit(47);
    }
    returned[0] = '0'; //le "0x" au début n'est pas obligatoire, mais je l'aime bien là où il est
    returned[1] = 'x';
    int a = size-1;
    char constants[16] = {'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'}; //ça évite d'avoir 16 if/else
    for (int i = 0; i <= a; i++) { //on commence du début car little endian
        uint8_t visualisation = (uint8_t) from_[i];
        returned[i*2+2] = constants[visualisation/16]; //prends les 4 bits du haut (1010 0101 -> 1010)
        returned[i*2+3] = constants[visualisation & 15]; //prends les 4 bits du bas (1010 0101 -> 0101) (grâce au & et parce que 15 c'est 0000 1111)
    }
    returned[size * 2 + 2] = '\0';
    
    return returned;
}

int main()
{
    CreateConsoleWindow();
    char a[16001] = "5765769341573556322338637728158450600013327968386464360701323435361242602352162333327519833894416557047329772903998436361563041621248558181274396444184696290116962732942201362548107949218477758281615003872880380330924475384175757379845426583997913493308651320221934802884197851170541758819126454188509997879301376474788161637618419201946852952803420740392393898501662811496139633953894419672350622677996030874578240656294870140255280144456684994579257333369928386052215927441369941559825876164795337497676274166584049560228085739910026651380281570121342104539180432300393246710849350660420448993432227398391263471694763096051622941580774955745917646032941566659732585554045466673930924542890990245519421699303286849595443173892391387712917184697328200108898400201039672518015265067467394048996634196085688595173316183555819179184296329434790930046525000410532641081379870184480293927518956308164842399376723367139779830585820851345430510443854028342502338830364312653155605925369489861166399081508082576576934157355632233863772815845060001332796838646436070132343536124260235216233332751983389441655704732977290399843636156304162124855818127439644418469629011696273294220136254810794921847775828161500387288038033092447538417575737984542658399791349330865132022193480288419785117054175881912645418850999787930137647478816163761841920194685295280342074039239389850166281149613963395389441967235062267799603087457824065629487014025528014445668499457925733336992838605221592744136994155982587616479533749767627416658404956022808573991002665138028157012134210453918043230039324671084935066042044899343222739839126347169476309605162294158077495574591764603294156665973258555404546667393092454289099024551942169930328684959544317389239138771291718469732820010889840020103967251801526506746739404899663419608568859517331618355581917918429632943479093004652500041053264108137987018448029392751895630816484239937672336713977983058582085134543051044385402834250233883036431265315560592536948986116639908150808257657693415735563223386377281584506000133279683864643607013234353612426023521623333275198338944165570473297729039984363615630416212485581812743964441846962901169627329422013625481079492184777582816150038728803803309244753841757573798454265839979134933086513202219348028841978511705417588191264541885099978793013764747881616376184192019468529528034207403923938985016628114961396339538944196723506226779960308745782406562948701402552801444566849945792573333699283860522159274413699415598258761647953374976762741665840495602280857399100266513802815701213421045391804323003932467108493506604204489934322273983912634716947630960516229415807749557459176460329415666597325855540454666739309245428909902455194216993032868495954431738923913877129171846973282001088984002010396725180152650674673940489966341960856885951733161835558191791842963294347909300465250004105326410813798701844802939275189563081648423993767233671397798305858208513454305104438540283425023388303643126531556059253694898611663990815080825765769341573556322338637728158450600013327968386464360701323435361242602352162333327519833894416557047329772903998436361563041621248558181274396444184696290116962732942201362548107949218477758281615003872880380330924475384175757379845426583997913493308651320221934802884197851170541758819126454188509997879301376474788161637618419201946852952803420740392393898501662811496139633953894419672350622677996030874578240656294870140255280144456684994579257333369928386052215927441369941559825876164795337497676274166584049560228085739910026651380281570121342104539180432300393246710849350660420448993432227398391263471694763096051622941580774955745917646032941566659732585554045466673930924542890990245519421699303286849595443173892391387712917184697328200108898400201039672518015265067467394048996634196085688595173316183555819179184296329434790930046525000410532641081379870184480293927518956308164842399376723367139779830585820851345430510443854028342502338830364312653155605925369489861166399081508082576576934157355632233863772815845060001332796838646436070132343536124260235216233332751983389441655704732977290399843636156304162124855818127439644418469629011696273294220136254810794921847775828161500387288038033092447538417575737984542658399791349330865132022193480288419785117054175881912645418850999787930137647478816163761841920194685295280342074039239389850166281149613963395389441967235062267799603087457824065629487014025528014445668499457925733336992838605221592744136994155982587616479533749767627416658404956022808573991002665138028157012134210453918043230039324671084935066042044899343222739839126347169476309605162294158077495574591764603294156665973258555404546667393092454289099024551942169930328684959544317389239138771291718469732820010889840020103967251801526506746739404899663419608568859517331618355581917918429632943479093004652500041053264108137987018448029392751895630816484239937672336713977983058582085134543051044385402834250233883036431265315560592536948986116639908150808257657693415735563223386377281584506000133279683864643607013234353612426023521623333275198338944165570473297729039984363615630416212485581812743964441846962901169627329422013625481079492184777582816150038728803803309244753841757573798454265839979134933086513202219348028841978511705417588191264541885099978793013764747881616376184192019468529528034207403923938985016628114961396339538944196723506226779960308745782406562948701402552801444566849945792573333699283860522159274413699415598258761647953374976762741665840495602280857399100266513802815701213421045391804323003932467108493506604204489934322273983912634716947630960516229415807749557459176460329415666597325855540454666739309245428909902455194216993032868495954431738923913877129171846973282001088984002010396725180152650674673940489966341960856885951733161835558191791842963294347909300465250004105326410813798701844802939275189563081648423993767233671397798305858208513454305104438540283425023388303643126531556059253694898611663990815080825765769341573556322338637728158450600013327968386464360701323435361242602352162333327519833894416557047329772903998436361563041621248558181274396444184696290116962732942201362548107949218477758281615003872880380330924475384175757379845426583997913493308651320221934802884197851170541758819126454188509997879301376474788161637618419201946852952803420740392393898501662811496139633953894419672350622677996030874578240656294870140255280144456684994579257333369928386052215927441369941559825876164795337497676274166584049560228085739910026651380281570121342104539180432300393246710849350660420448993432227398391263471694763096051622941580774955745917646032941566659732585554045466673930924542890990245519421699303286849595443173892391387712917184697328200108898400201039672518015265067467394048996634196085688595173316183555819179184296329434790930046525000410532641081379870184480293927518956308164842399376723367139779830585820851345430510443854028342502338830364312653155605925369489861166399081508082576576934157355632233863772815845060001332796838646436070132343536124260235216233332751983389441655704732977290399843636156304162124855818127439644418469629011696273294220136254810794921847775828161500387288038033092447538417575737984542658399791349330865132022193480288419785117054175881912645418850999787930137647478816163761841920194685295280342074039239389850166281149613963395389441967235062267799603087457824065629487014025528014445668499457925733336992838605221592744136994155982587616479533749767627416658404956022808573991002665138028157012134210453918043230039324671084935066042044899343222739839126347169476309605162294158077495574591764603294156665973258555404546667393092454289099024551942169930328684959544317389239138771291718469732820010889840020103967251801526506746739404899663419608568859517331618355581917918429632943479093004652500041053264108137987018448029392751895630816484239937672336713977983058582085134543051044385402834250233883036431265315560592536948986116639908150808257657693415735563223386377281584506000133279683864643607013234353612426023521623333275198338944165570473297729039984363615630416212485581812743964441846962901169627329422013625481079492184777582816150038728803803309244753841757573798454265839979134933086513202219348028841978511705417588191264541885099978793013764747881616376184192019468529528034207403923938985016628114961396339538944196723506226779960308745782406562948701402552801444566849945792573333699283860522159274413699415598258761647953374976762741665840495602280857399100266513802815701213421045391804323003932467108493506604204489934322273983912634716947630960516229415807749557459176460329415666597325855540454666739309245428909902455194216993032868495954431738923913877129171846973282001088984002010396725180152650674673940489966341960856885951733161835558191791842963294347909300465250004105326410813798701844802939275189563081648423993767233671397798305858208513454305104438540283425023388303643126531556059253694898611663990815080825765769341573556322338637728158450600013327968386464360701323435361242602352162333327519833894416557047329772903998436361563041621248558181274396444184696290116962732942201362548107949218477758281615003872880380330924475384175757379845426583997913493308651320221934802884197851170541758819126454188509997879301376474788161637618419201946852952803420740392393898501662811496139633953894419672350622677996030874578240656294870140255280144456684994579257333369928386052215927441369941559825876164795337497676274166584049560228085739910026651380281570121342104539180432300393246710849350660420448993432227398391263471694763096051622941580774955745917646032941566659732585554045466673930924542890990245519421699303286849595443173892391387712917184697328200108898400201039672518015265067467394048996634196085688595173316183555819179184296329434790930046525000410532641081379870184480293927518956308164842399376723367139779830585820851345430510443854028342502338830364312653155605925369489861166399081508082576576934157355632233863772815845060001332796838646436070132343536124260235216233332751983389441655704732977290399843636156304162124855818127439644418469629011696273294220136254810794921847775828161500387288038033092447538417575737984542658399791349330865132022193480288419785117054175881912645418850999787930137647478816163761841920194685295280342074039239389850166281149613963395389441967235062267799603087457824065629487014025528014445668499457925733336992838605221592744136994155982587616479533749767627416658404956022808573991002665138028157012134210453918043230039324671084935066042044899343222739839126347169476309605162294158077495574591764603294156665973258555404546667393092454289099024551942169930328684959544317389239138771291718469732820010889840020103967251801526506746739404899663419608568859517331618355581917918429632943479093004652500041053264108137987018448029392751895630816484239937672336713977983058582085134543051044385402834250233883036431265315560592536948986116639908150808257657693415735563223386377281584506000133279683864643607013234353612426023521623333275198338944165570473297729039984363615630416212485581812743964441846962901169627329422013625481079492184777582816150038728803803309244753841757573798454265839979134933086513202219348028841978511705417588191264541885099978793013764747881616376184192019468529528034207403923938985016628114961396339538944196723506226779960308745782406562948701402552801444566849945792573333699283860522159274413699415598258761647953374976762741665840495602280857399100266513802815701213421045391804323003932467108493506604204489934322273983912634716947630960516229415807749557459176460329415666597325855540454666739309245428909902455194216993032868495954431738923913877129171846973282001088984002010396725180152650674673940489966341960856885951733161835558191791842963294347909300465250004105326410813798701844802939275189563081648423993767233671397798305858208513454305104438540283425023388303643126531556059253694898611663990815080825765769341573556322338637728158450600013327968386464360701323435361242602352162333327519833894416557047329772903998436361563041621248558181274396444184696290116962732942201362548107949218477758281615003872880380330924475384175757379845426583997913493308651320221934802884197851170541758819126454188509997879301376474788161637618419201946852952803420740392393898501662811496139633953894419672350622677996030874578240656294870140255280144456684994579257333369928386052215927441369941559825876164795337497676274166584049560228085739910026651380281570121342104539180432300393246710849350660420448993432227398391263471694763096051622941580774955745917646032941566659732585554045466673930924542890990245519421699303286849595443173892391387712917184697328200108898400201039672518015265067467394048996634196085688595173316183555819179184296329434790930046525000410532641081379870184480293927518956308164842399376723367139779830585820851345430510443854028342502338830364312653155605925369489861166399081508082576576934157355632233863772815845060001332796838646436070132343536124260235216233332751983389441655704732977290399843636156304162124855818127439644418469629011696273294220136254810794921847775828161500387288038033092447538417575737984542658399791349330865132022193480288419785117054175881912645418850999787930137647478816163761841920194685295280342074039239389850166281149613963395389441967235062267799603087457824065629487014025528014445668499457925733336992838605221592744136994155982587616479533749767627416658404956022808573991002665138028157012134210453918043230039324671084935066042044899343222739839126347169476309605162294158077495574591764603294156665973258555404546667393092454289099024551942169930328684959544317389239138771291718469732820010889840020103967251801526506746739404899663419608568859517331618355581917918429632943479093004652500041053264108137987018448029392751895630816484239937672336713977983058582085134543051044385402834250233883036431265315560592536948986116639908150808257657693415735563223386377281584506000133279683864643607013234353612426023521623333275198338944165570473297729039984363615630416212485581812743964441846962901169627329422013625481079492184777582816150038728803803309244753841757573798454265839979134933086513202219348028841978511705417588191264541885099978793013764747881616376184192019468529528034207403923938985016628114961396339538944196723506226779960308745782406562948701402552801444566849945792573333699283860522159274413699415598258761647953374976762741665840495602280857399100266513802815701213421045391804323003932467108493506604204489934322273983912634716947630960516229415807749557459176460329415666597325855540454666739309245428909902455194216993032868495954431738923913877129171846973282001088984002010396725180152650674673940489966341960856885951733161835558191791842963294347909300465250004105326410813798701844802939275189563081648423993767233671397798305858208513454305104438540283425023388303643126531556059253694898611663990815080825765769341573556322338637728158450600013327968386464360701323435361242602352162333327519833894416557047329772903998436361563041621248558181274396444184696290116962732942201362548107949218477758281615003872880380330924475384175757379845426583997913493308651320221934802884197851170541758819126454188509997879301376474788161637618419201946852952803420740392393898501662811496139633953894419672350622677996030874578240656294870140255280144456684994579257333369928386052215927441369941559825876164795337497676274166584049560228085739910026651380281570121342104539180432300393246710849350660420448993432227398391263471694763096051622941580774955745917646032941566659732585554045466673930924542890990245519421699303286849595443173892391387712917184697328200108898400201039672518015265067467394048996634196085688595173316183555819179184296329434790930046525000410532641081379870184480293927518956308164842399376723367139779830585820851345430510443854028342502338830364312653155605925369489861166399081508082";
    char b[16001] = "9900725773507540559625301712634760007304784411193455591157234014940625021540131003006912763210689182358262585151741779457961077934015300407077492731211503261393555516587153730316136797628145858848974842604216800298498943424851294073258305443015663711443365594847916078005695082244692243887440133876284412366920938127214387220880432641102474520300671522219328785175491758159251310351184003983457113565261788838349648884073241357663391275590574558002928678472895153265993029708745104157204851540039110803092999343948784814617324749998285763111598152824385449134750235340923400360007081302058221888744118583399231500225218142888577844284451692448483961103127610652767666831084742302922561832317512588762083532268679914776253540236283086380962740966358727477055717991382746264835287613881470315336366298393535275872662487022699766300084135321126085698154381923594120519118184084511186279310914203988066392519931704339623642726271013016300398172066413052457510489465361609470995099227809513503516745805246990072577350754055962530171263476000730478441119345559115723401494062502154013100300691276321068918235826258515174177945796107793401530040707749273121150326139355551658715373031613679762814585884897484260421680029849894342485129407325830544301566371144336559484791607800569508224469224388744013387628441236692093812721438722088043264110247452030067152221932878517549175815925131035118400398345711356526178883834964888407324135766339127559057455800292867847289515326599302970874510415720485154003911080309299934394878481461732474999828576311159815282438544913475023534092340036000708130205822188874411858339923150022521814288857784428445169244848396110312761065276766683108474230292256183231751258876208353226867991477625354023628308638096274096635872747705571799138274626483528761388147031533636629839353527587266248702269976630008413532112608569815438192359412051911818408451118627931091420398806639251993170433962364272627101301630039817206641305245751048946536160947099509922780951350351674580524699007257735075405596253017126347600073047844111934555911572340149406250215401310030069127632106891823582625851517417794579610779340153004070774927312115032613935555165871537303161367976281458588489748426042168002984989434248512940732583054430156637114433655948479160780056950822446922438874401338762844123669209381272143872208804326411024745203006715222193287851754917581592513103511840039834571135652617888383496488840732413576633912755905745580029286784728951532659930297087451041572048515400391108030929993439487848146173247499982857631115981528243854491347502353409234003600070813020582218887441185833992315002252181428885778442844516924484839611031276106527676668310847423029225618323175125887620835322686799147762535402362830863809627409663587274770557179913827462648352876138814703153363662983935352758726624870226997663000841353211260856981543819235941205191181840845111862793109142039880663925199317043396236427262710130163003981720664130524575104894653616094709950992278095135035167458052469900725773507540559625301712634760007304784411193455591157234014940625021540131003006912763210689182358262585151741779457961077934015300407077492731211503261393555516587153730316136797628145858848974842604216800298498943424851294073258305443015663711443365594847916078005695082244692243887440133876284412366920938127214387220880432641102474520300671522219328785175491758159251310351184003983457113565261788838349648884073241357663391275590574558002928678472895153265993029708745104157204851540039110803092999343948784814617324749998285763111598152824385449134750235340923400360007081302058221888744118583399231500225218142888577844284451692448483961103127610652767666831084742302922561832317512588762083532268679914776253540236283086380962740966358727477055717991382746264835287613881470315336366298393535275872662487022699766300084135321126085698154381923594120519118184084511186279310914203988066392519931704339623642726271013016300398172066413052457510489465361609470995099227809513503516745805246990072577350754055962530171263476000730478441119345559115723401494062502154013100300691276321068918235826258515174177945796107793401530040707749273121150326139355551658715373031613679762814585884897484260421680029849894342485129407325830544301566371144336559484791607800569508224469224388744013387628441236692093812721438722088043264110247452030067152221932878517549175815925131035118400398345711356526178883834964888407324135766339127559057455800292867847289515326599302970874510415720485154003911080309299934394878481461732474999828576311159815282438544913475023534092340036000708130205822188874411858339923150022521814288857784428445169244848396110312761065276766683108474230292256183231751258876208353226867991477625354023628308638096274096635872747705571799138274626483528761388147031533636629839353527587266248702269976630008413532112608569815438192359412051911818408451118627931091420398806639251993170433962364272627101301630039817206641305245751048946536160947099509922780951350351674580524699007257735075405596253017126347600073047844111934555911572340149406250215401310030069127632106891823582625851517417794579610779340153004070774927312115032613935555165871537303161367976281458588489748426042168002984989434248512940732583054430156637114433655948479160780056950822446922438874401338762844123669209381272143872208804326411024745203006715222193287851754917581592513103511840039834571135652617888383496488840732413576633912755905745580029286784728951532659930297087451041572048515400391108030929993439487848146173247499982857631115981528243854491347502353409234003600070813020582218887441185833992315002252181428885778442844516924484839611031276106527676668310847423029225618323175125887620835322686799147762535402362830863809627409663587274770557179913827462648352876138814703153363662983935352758726624870226997663000841353211260856981543819235941205191181840845111862793109142039880663925199317043396236427262710130163003981720664130524575104894653616094709950992278095135035167458052469900725773507540559625301712634760007304784411193455591157234014940625021540131003006912763210689182358262585151741779457961077934015300407077492731211503261393555516587153730316136797628145858848974842604216800298498943424851294073258305443015663711443365594847916078005695082244692243887440133876284412366920938127214387220880432641102474520300671522219328785175491758159251310351184003983457113565261788838349648884073241357663391275590574558002928678472895153265993029708745104157204851540039110803092999343948784814617324749998285763111598152824385449134750235340923400360007081302058221888744118583399231500225218142888577844284451692448483961103127610652767666831084742302922561832317512588762083532268679914776253540236283086380962740966358727477055717991382746264835287613881470315336366298393535275872662487022699766300084135321126085698154381923594120519118184084511186279310914203988066392519931704339623642726271013016300398172066413052457510489465361609470995099227809513503516745805246990072577350754055962530171263476000730478441119345559115723401494062502154013100300691276321068918235826258515174177945796107793401530040707749273121150326139355551658715373031613679762814585884897484260421680029849894342485129407325830544301566371144336559484791607800569508224469224388744013387628441236692093812721438722088043264110247452030067152221932878517549175815925131035118400398345711356526178883834964888407324135766339127559057455800292867847289515326599302970874510415720485154003911080309299934394878481461732474999828576311159815282438544913475023534092340036000708130205822188874411858339923150022521814288857784428445169244848396110312761065276766683108474230292256183231751258876208353226867991477625354023628308638096274096635872747705571799138274626483528761388147031533636629839353527587266248702269976630008413532112608569815438192359412051911818408451118627931091420398806639251993170433962364272627101301630039817206641305245751048946536160947099509922780951350351674580524699007257735075405596253017126347600073047844111934555911572340149406250215401310030069127632106891823582625851517417794579610779340153004070774927312115032613935555165871537303161367976281458588489748426042168002984989434248512940732583054430156637114433655948479160780056950822446922438874401338762844123669209381272143872208804326411024745203006715222193287851754917581592513103511840039834571135652617888383496488840732413576633912755905745580029286784728951532659930297087451041572048515400391108030929993439487848146173247499982857631115981528243854491347502353409234003600070813020582218887441185833992315002252181428885778442844516924484839611031276106527676668310847423029225618323175125887620835322686799147762535402362830863809627409663587274770557179913827462648352876138814703153363662983935352758726624870226997663000841353211260856981543819235941205191181840845111862793109142039880663925199317043396236427262710130163003981720664130524575104894653616094709950992278095135035167458052469900725773507540559625301712634760007304784411193455591157234014940625021540131003006912763210689182358262585151741779457961077934015300407077492731211503261393555516587153730316136797628145858848974842604216800298498943424851294073258305443015663711443365594847916078005695082244692243887440133876284412366920938127214387220880432641102474520300671522219328785175491758159251310351184003983457113565261788838349648884073241357663391275590574558002928678472895153265993029708745104157204851540039110803092999343948784814617324749998285763111598152824385449134750235340923400360007081302058221888744118583399231500225218142888577844284451692448483961103127610652767666831084742302922561832317512588762083532268679914776253540236283086380962740966358727477055717991382746264835287613881470315336366298393535275872662487022699766300084135321126085698154381923594120519118184084511186279310914203988066392519931704339623642726271013016300398172066413052457510489465361609470995099227809513503516745805246990072577350754055962530171263476000730478441119345559115723401494062502154013100300691276321068918235826258515174177945796107793401530040707749273121150326139355551658715373031613679762814585884897484260421680029849894342485129407325830544301566371144336559484791607800569508224469224388744013387628441236692093812721438722088043264110247452030067152221932878517549175815925131035118400398345711356526178883834964888407324135766339127559057455800292867847289515326599302970874510415720485154003911080309299934394878481461732474999828576311159815282438544913475023534092340036000708130205822188874411858339923150022521814288857784428445169244848396110312761065276766683108474230292256183231751258876208353226867991477625354023628308638096274096635872747705571799138274626483528761388147031533636629839353527587266248702269976630008413532112608569815438192359412051911818408451118627931091420398806639251993170433962364272627101301630039817206641305245751048946536160947099509922780951350351674580524699007257735075405596253017126347600073047844111934555911572340149406250215401310030069127632106891823582625851517417794579610779340153004070774927312115032613935555165871537303161367976281458588489748426042168002984989434248512940732583054430156637114433655948479160780056950822446922438874401338762844123669209381272143872208804326411024745203006715222193287851754917581592513103511840039834571135652617888383496488840732413576633912755905745580029286784728951532659930297087451041572048515400391108030929993439487848146173247499982857631115981528243854491347502353409234003600070813020582218887441185833992315002252181428885778442844516924484839611031276106527676668310847423029225618323175125887620835322686799147762535402362830863809627409663587274770557179913827462648352876138814703153363662983935352758726624870226997663000841353211260856981543819235941205191181840845111862793109142039880663925199317043396236427262710130163003981720664130524575104894653616094709950992278095135035167458052469900725773507540559625301712634760007304784411193455591157234014940625021540131003006912763210689182358262585151741779457961077934015300407077492731211503261393555516587153730316136797628145858848974842604216800298498943424851294073258305443015663711443365594847916078005695082244692243887440133876284412366920938127214387220880432641102474520300671522219328785175491758159251310351184003983457113565261788838349648884073241357663391275590574558002928678472895153265993029708745104157204851540039110803092999343948784814617324749998285763111598152824385449134750235340923400360007081302058221888744118583399231500225218142888577844284451692448483961103127610652767666831084742302922561832317512588762083532268679914776253540236283086380962740966358727477055717991382746264835287613881470315336366298393535275872662487022699766300084135321126085698154381923594120519118184084511186279310914203988066392519931704339623642726271013016300398172066413052457510489465361609470995099227809513503516745805246990072577350754055962530171263476000730478441119345559115723401494062502154013100300691276321068918235826258515174177945796107793401530040707749273121150326139355551658715373031613679762814585884897484260421680029849894342485129407325830544301566371144336559484791607800569508224469224388744013387628441236692093812721438722088043264110247452030067152221932878517549175815925131035118400398345711356526178883834964888407324135766339127559057455800292867847289515326599302970874510415720485154003911080309299934394878481461732474999828576311159815282438544913475023534092340036000708130205822188874411858339923150022521814288857784428445169244848396110312761065276766683108474230292256183231751258876208353226867991477625354023628308638096274096635872747705571799138274626483528761388147031533636629839353527587266248702269976630008413532112608569815438192359412051911818408451118627931091420398806639251993170433962364272627101301630039817206641305245751048946536160947099509922780951350351674580524699007257735075405596253017126347600073047844111934555911572340149406250215401310030069127632106891823582625851517417794579610779340153004070774927312115032613935555165871537303161367976281458588489748426042168002984989434248512940732583054430156637114433655948479160780056950822446922438874401338762844123669209381272143872208804326411024745203006715222193287851754917581592513103511840039834571135652617888383496488840732413576633912755905745580029286784728951532659930297087451041572048515400391108030929993439487848146173247499982857631115981528243854491347502353409234003600070813020582218887441185833992315002252181428885778442844516924484839611031276106527676668310847423029225618323175125887620835322686799147762535402362830863809627409663587274770557179913827462648352876138814703153363662983935352758726624870226997663000841353211260856981543819235941205191181840845111862793109142039880663925199317043396236427262710130163003981720664130524575104894653616094709950992278095135035167458052469900725773507540559625301712634760007304784411193455591157234014940625021540131003006912763210689182358262585151741779457961077934015300407077492731211503261393555516587153730316136797628145858848974842604216800298498943424851294073258305443015663711443365594847916078005695082244692243887440133876284412366920938127214387220880432641102474520300671522219328785175491758159251310351184003983457113565261788838349648884073241357663391275590574558002928678472895153265993029708745104157204851540039110803092999343948784814617324749998285763111598152824385449134750235340923400360007081302058221888744118583399231500225218142888577844284451692448483961103127610652767666831084742302922561832317512588762083532268679914776253540236283086380962740966358727477055717991382746264835287613881470315336366298393535275872662487022699766300084135321126085698154381923594120519118184084511186279310914203988066392519931704339623642726271013016300398172066413052457510489465361609470995099227809513503516745805246";
    timespec my_time = {0, 0};
    timespec new_time = {0, 0};
    if (timespec_get(&my_time, TIME_UTC) == NULL) {
        exit(61);
    }

    int a_len = 0;
    int b_len = 0;
    uint8_t* a_conv = conv(a,&a_len);
    uint8_t* b_conv = conv(b,&b_len);
    char* a_str = convert_to_str(a_conv, a_len);
    char* b_str = convert_to_str(b_conv,b_len);
    int c_len = 0;
    uint8_t* c_conv = addition_uint(a_conv,a_len,b_conv,b_len,&c_len);
    char* c_str = convert_to_str(c_conv,c_len);

    if (timespec_get(&new_time, TIME_UTC) == NULL) {
        exit(60);
    }

    //calcul du temps que ça à pris (simple soustraction)
    long final_time = new_time.tv_sec-my_time.tv_sec ;
    long final_time_2 = new_time.tv_nsec-my_time.tv_nsec;
    printf("nombre a : %s\n", a_str);
    printf("\n");
    printf("nombre b : %s\n",b_str);
    printf("\n");
    printf("addition a+b : %s\n",c_str);
    printf("\n");
    if (final_time_2 < 0) {
        final_time -= 1;
        final_time_2 += 1000000000 ;
    }
    printf("final_time : %ld.%09ld",final_time,final_time_2);
    printf("\nin microseconds : %ld micro seconds", final_time * 1000000 + final_time_2 / 1000);
    return 0;
}

